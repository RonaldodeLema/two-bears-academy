@using EcommerceCore.Const;
@using Ecommerce.Helper;
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Ecommerce</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" type="text/css" href="~/css/custom_style.css">
    <!-- Font Awesome-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/fontawesome.css">
    <!-- ico-font-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/icofont.css">
    <link rel="stylesheet" type="text/css" href="~/assets/icofont.min.css">
    <!-- Themify icon-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/themify.css">
    <!-- Flag icon-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/flag-icon.css">
    <!-- Feather icon-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/feather-icon.css">
    <!-- Plugins css start-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/prism.css">
    <!-- Plugins css start-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/select2.css">
    <link rel="stylesheet" type="text/css" href="~/assets/css/owlcarousel.css">
    <link rel="stylesheet" type="text/css" href="~/assets/css/range-slider.css">
    <link rel="stylesheet" type="text/css" href="~/assets/css/datatables.css">
    <!-- Plugins css Ends-->
    <!-- Bootstrap css-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/bootstrap.css">
    <!-- App css-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/style.css">
    <link id="color" rel="stylesheet" href="~/assets/css/color-7.css" media="screen">
    <!-- Responsive css-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/responsive.css">
    <link href="~/assets/select2/dist/css/select2.min.css" rel="stylesheet" />

    <!-- Plugins css start-->
    <link rel="stylesheet" type="text/css" href="~/assets/css/slick.css">
    <link rel="stylesheet" type="text/css" href="~/assets/css/slick-theme.css">
    <link rel="stylesheet" type="text/css" href="~/assets/css/rating.css">

</head>
<body class="">
    <!-- Loader starts-->
    @*<div class="loader-wrapper">
    <div class="theme-loader">
    <div class="loader-p"></div>
    </div>
    </div>*@
    <!-- Loader ends-->
    <!-- page-wrapper Start-->
    <div class="page-wrapper compact-wrapper" id="pageWrapper">
        <!-- Page Header Start-->
        <div class="page-main-header" style="z-index:99">
            <div class="main-header-right row m-0">
                <div class="main-header-left py-2">
                    <div class="logo-wrapper">
                        <a href="/" class="my-auto">
                            <div class="d-flex my-auto">
                                <img class="img-fluid" src="~/@SystemDisplay.LogoFavicon" alt="" style="width: 35px; height: 35px">
                                <h4 class="fw-bold my-auto ms-2">X-Profile</h4>
                            </div>
                        </a>
                    </div>
                    <div class="dark-logo-wrapper">
                        <a href="/">
                            <div class="d-flex my-auto">
                                <img class="img-fluid" src="~/@SystemDisplay.LogoFavicon" alt="" style="width: 35px; height: 35px ">
                                <h4 class="fw-bold my-auto ms-2">X-Profile</h4>
                            </div>
                        </a>
                    </div>
                    <div id="sidebar-toggle">
                        <div class="toggle-sidebar"><i class="status_toggle middle" data-feather="align-center"></i></div>
                    </div>

                </div>
                <div class="left-menu-header col d-flex">
                    <ul class="my-auto">
                        <li class="dropdown">
                        </li>
                    </ul>
                </div>
                <div class="nav-right col pull-right right-menu p-0">
                    <ul class="nav-menus">
                        <li>
                            <a href="@Url.Action("News", "HomeEndUser")">
                                <div class="notification-box">
                                    <i data-feather="bell">
                                    </i>
                                    <span class="dot-animated">
                                    </span>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a asp-controller="Cart" asp-action="Index">
                                <i class="fa fa-shopping-cart">
                                </i>
                            </a>
                        </li>
                        <li class="dropdown p-0">
                            @*<a class="btn btn-primary-light py-2" href="/User/Logout"><i data-feather="log-out"></i>Đăng xuất</a>*@
                            <div class="btn btn-primary-light text-start py-1 px-2" data-bs-toggle="dropdown" aria-expanded="false">
                                @{
                                    string userName = "";
                                    var user = Context.Session.GetCurrentAuthentication();
                                    if (user != null)
                                    {
                                        userName = user.Name;
                                    }
                                }
                                @if (user != null)
                                {
                                    <div class="my-auto">

                                        <img src="@user.AvatarUrl" class="rounded-circle mr-2" style="height: 30px; width: 30px; object-fit: cover " />
                                        <span> @user.Name</span>
                                    </div>
                                }
                                else
                                {
                                    <div class="my-auto">
                                        <span> Annonymous</span>
                                    </div>

                                }

                            </div>
                            @if (user != null)
                            {
                                <div class="dropdown-menu dropdown-menu-end">
                                    <a class="dropdown-item" href="@Url.Action("Index", "UserProfile")">Cập nhật thông tin</a>
                                    <a class="dropdown-item" href="@Url.Action("ProductHistory", "ProductEndUser", new {userId = Context.Session.GetCurrentAuthentication().UserId })">Sản phẩm đã xem</a>
                                    <a class="dropdown-item" href="@Url.Action("OrderHistory", "HomeEndUser", new {userId = Context.Session.GetCurrentAuthentication().UserId })">Lịch sử đơn hàng</a>
                                    @*<a class="dropdown-item" href="/Account/ChangePassword">Đổi mật khẩu</a>*@
                                    <a class="dropdown-item" href="@Url.Action("Logout", "UserProfile")">Đăng xuất</a>
                                </div>
                            }
                            else
                            {
                                <div class="dropdown-menu dropdown-menu-end">
                                    <a class="dropdown-item" href="@Url.Action("Login", "HomeEndUser")">Đăng nhập</a>
                                    <a class="dropdown-item" href="@Url.Action("Register", "HomeEndUser")">Đăng ký</a>
                                </div>
                            }

                        </li>

                    </ul>
                </div>
                <div class="d-lg-none mobile-toggle pull-right w-auto"><i data-feather="more-horizontal"></i></div>
            </div>
        </div>


        <div aria-live="polite" aria-atomic="true" style="position: relative;">
            <div class="toast toast-notification" id="toastbtn" style="position: absolute; top: 0; right: 0; width:400px;z-index:10000;display:none;">
                <div class="toast-header bg bg-success">
                    <strong class="mr-auto">Thông báo</strong>
                    <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="toast-body">
                    <div id="resultMesage">
                    </div>
                </div>
            </div>
            <div id="confirmationToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true" style="display:none; position: absolute; top: 0; right: 0; width:400px;z-index: 1000;">
                <div class="toast-header">
                    <strong class="mr-auto">Bạn có chắc không?</strong>
                    <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="toast-body">
                    <div>Bạn có chắc thực thi tác vụ này?</div>
                    <button class="btn btn-danger" id="btnConfirm" data-id="0" data-data="">Có</button>
                    <button class="btn btn-default" data-dismiss="toast">Không</button>
                </div>
            </div>
            <div id="confirmationDynamic" class="toast" role="alert" aria-live="assertive" aria-atomic="true" style="display:none; position: absolute; top: 0; right: 0; width:400px;z-index: 1000;">
                <div class="toast-header">
                    <strong class="mr-auto">Bạn có chắc không?</strong>
                    <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="toast-body">
                    <div>Bạn có chắc thực thi tác vụ này?</div>
                    <button class="btn btn-danger" id="btnConfirmDynamic" data-id="0" data-data="" data-url="">Có</button>
                    <button class="btn btn-default" data-dismiss="toast">Không</button>
                </div>
            </div>
        </div>
        <!-- Page Header Ends                              -->
        <!-- Page Body Start-->
        <div class="page-body" style="margin-left: 50px; margin-top: 100px;">
            <!-- Page Sidebar Start-->
            <partial name="__MainMenu" />
            <!-- Page Sidebar Ends-->
            <div class="page-body">
                @RenderBody()

                <!-- Container-fluid starts-->
                <div class="container-fluid">
                </div>
                <!-- Container-fluid Ends-->
                <div id="fb-root"></div>

                <!-- Your Plugin chat code -->
                <div id="fb-customer-chat" class="fb-customerchat">
                </div>

                <script>
                    var chatbox = document.getElementById('fb-customer-chat');
                    chatbox.setAttribute("page_id", "970520406358216");
                    chatbox.setAttribute("attribution", "biz_inbox");
                </script>

                <!-- Your SDK code -->
                <script>
                    window.fbAsyncInit = function () {
                        FB.init({
                            xfbml: true,
                            version: 'v16.0'
                        });
                    };

                    (function (d, s, id) {
                        var js, fjs = d.getElementsByTagName(s)[0];
                        if (d.getElementById(id)) return;
                        js = d.createElement(s); js.id = id;
                        js.src = 'https://connect.facebook.net/vi_VN/sdk/xfbml.customerchat.js';
                        fjs.parentNode.insertBefore(js, fjs);
                    }(document, 'script', 'facebook-jssdk'));
                </script>
            </div>
            <!-- footer start-->
            @* <footer class="footer" style="margin-left: 0px !important;">
            <div class="container-fluid">
            <div class="row">
            <div class="col-md-6 footer-copyright">
            &copy; @DateTime.Now.Year <a href="#">XProfile Company</a>. All Rights Reserved.
            </div>

            </div>
            </div>
            </footer>*@
            <!-- Messenger Plugin chat Code -->

        </div>
    </div>
    <div class="modal fade" id="modal-warning">
        <div class="modal-dialog">
            <div class="modal-content ">
                <div class="modal-header">
                    <h4 class="modal-title" id="warning-modal-title">Warning Modal</h4>
                    <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close" data-bs-original-title="" title=""></button>
                </div>
                <div class="modal-body" id="warning-modal-body">
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" id="warning-modal-cancel" type="button" data-bs-dismiss="modal" data-bs-original-title="" title="">Đóng</button>
                    <button class="btn btn-primary" id="warning-modal-confirm" type="button" data-bs-original-title="" title="">Xác nhận</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    @RenderSection("Modals", required: false)
    <!-- ./wrapper -->
    <!-- latest jquery-->
    <script src="~/assets/js/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="~/lib/jquery.unobtrusive-ajax.js"></script>

    <!-- feather icon js-->
    <script src="~/assets/js/icons/feather-icon/feather.min.js"></script>
    <script src="~/assets/js/icons/feather-icon/feather-icon.js"></script>
    @*<script src="https://code.iconify.design/iconify-icon/1.0.0-beta.3/iconify-icon.min.js"></script>*@
    <!-- Sidebar jquery-->
    <script src="~/assets/js/sidebar-menu.js"></script>
    <script src="~/assets/js/config.js"></script>
    <!-- Bootstrap js-->
    <script src="~/assets/js/bootstrap/popper.min.js"></script>

    <script src="~/assets/js/jquery.ui.min.js"></script>
    <script src="~/assets/js/bootstrap/bootstrap.min.js"></script>
    <!-- Plugins JS start-->
    <script src="~/assets/js/prism/prism.min.js"></script>
    <script src="~/assets/js/clipboard/clipboard.min.js"></script>
    <!-- Plugins JS Ends-->
    <!-- Theme js-->
    <script src="~/assets/js/script.js"></script>
    <!--Sortable JS-->
    <script src="~/assets/select2/dist/js/select2.full.min.js"></script>
    <script src="~/assets/js/custom-card/custom-card.js"></script>
    <script src="~/assets/js/editor/ckeditor/ckeditor.js"></script>
    <script src="~/assets/js/editor/ckeditor/adapters/jquery.js"></script>
    <script src="~/assets/js/editor/ckeditor/styles.js"></script>
    <script src="~/assets/js/range-slider/ion.rangeSlider.min.js"></script>
    <script src="~/assets/js/range-slider/rangeslider-script.js"></script>
    <script src="~/assets/js/touchspin/vendors.min.js"></script>
    <script src="~/assets/js/touchspin/touchspin.js"></script>
    <script src="~/assets/js/touchspin/input-groups.min.js"></script>
    <script src="~/assets/js/owlcarousel/owl.carousel.js"></script>
    <script src="~/assets/js/select2/select2.full.min.js"></script>
    <script src="~/assets/js/select2/select2-custom.js"></script>
    <script src="~/assets/js/tooltip-init.js"></script>
    <script src="~/assets/js/product-tab.js"></script>
    @*//product detail*@
    <script src="~/assets/js/rating/rating-script.js"></script>
    <script src="~/assets/js/rating/jquery.barrating.js"></script>
    <script src="~/assets/js/slick-slider/slick.min.js"></script>
    <script src="~/assets/js/slick-slider/slick-theme.js"></script>
    <script src="~/assets/js/script.js"></script>
    @*<script src="~/assets/js/theme-customizer/customizer.js"></script>*@
    <script>
        $(document).ready(function () {
            let curActiveMenu = $("#mainnav li a.link-nav.active");
            if (curActiveMenu.length) {
                let curActiveMenuPos = curActiveMenu.offset().top - (90);
                $("#mainnav .nav-menu").scrollTop(curActiveMenuPos);
            }
            $(".select2").select2();
            $('.select2-ajax').each(function () {
                let input = $(this);
                let url = input.data("ajax-url");
                if (!url) {
                    console.log("select2-ajax: lack of ajax-url data");
                    return;
                }
                input.select2({
                    //minimumResultsForSearch: Infinity,
                    ajax: {
                        url: url,
                        data: function (params) {
                            var query = {
                                keyword: params.term,
                                page: params.page || 1,
                            }
                            return query;
                        },
                        processResults: function (data, params) {
                            params.page = params.page || 1;
                            return {
                                'results': data.result,
                                'pagination': {
                                    'more': data.more,
                                }
                            };
                        },
                        delay: 500,
                    }
                });
            });
        });
        function showModalConfirm(title, htmlContent, action) {
            $("#modal-warning").modal("show");
            $("#warning-modal-title").html(title);
            $("#warning-modal-body").html(htmlContent);
            $("button#warning-modal-confirm").click(function (e) {
                e.preventDefault();
                $("button#warning-modal-cancel").click();
                action();
                $("button#warning-modal-confirm").unbind("click");
                $("#modal-warning").modal("hide");
            });

        }
    </script>

    <script>
        $(document).ready(function () {
            if ($("textarea").length > 0) {
                $("textarea").each(function () {
                    var textarea = $(this);
                    var isNotApply = textarea.hasClass("not-apply");
                    var isAce = textarea.hasClass("ace_text-input");
                    var duplicateTextarea = textarea.hasClass("note-codable");
                    if (isNotApply == false && isAce == false && duplicateTextarea == false) {
                        textarea.ckeditor();
                    }
                });
            }
            if ($(".apply-editor").length > 0) {
                $(".apply-editor").each(function () {
                    var editorEle = $(this);
                    var tmpHtml = editorEle.next();
                    var initValue = tmpHtml.val();
                    var idElement = editorEle.attr('id');
                    var editorElement = document.querySelector('#' + idElement);
                    const Editor = toastui.Editor;

                    const colorSyntax = Editor.plugin.colorSyntax;
                    const editor = new Editor({
                        el: editorElement,
                        plugins: [colorSyntax],
                        toolbarItems: [
                            ['heading', 'bold', 'italic', 'strike', 'hr'],
                            ['image', 'link'],
                            ['ul', 'ol'],
                        ],
                        height: '500px',
                        initialEditType: 'WYSIWYG',
                        //initialValue: initValue,
                        previewStyle: 'vertical',
                        events: {
                            change: function () {
                                const htmlData = editor.getHTML();
                                tmpHtml.val(htmlData);
                            },

                        },
                        autofocus: false,


                    });
                    console.log(editor);
                    editor.setHTML(initValue);

                });
            }
        });


    </script>

    @RenderSection("SubScripts", required: false)
    @RenderSection("Scripts", required: false)

</body>

</html>
